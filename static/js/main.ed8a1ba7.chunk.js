(this.webpackJsonpeventful=this.webpackJsonpeventful||[]).push([[0],{24:function(t,e,n){},45:function(t,e,n){"use strict";n.r(e);var i=n(2),r=n.n(i),a=n(18),s=n.n(a),c=(n(24),n(3)),o=n(4),u=n(6),d=n(5),l=n(8),b=n.n(l),j=n(19),h=n(9),v=n.n(h),p="https://bootcamp-week14-eventful.herokuapp.com/",O=function(){function t(e,n){Object(c.a)(this,t),this.tokenProvider=e,this.logoutHandler=n}return Object(o.a)(t,[{key:"authenticatedApiFetch",value:function(t,e,n){var i=this;return v()({method:t,url:e,headers:{authorization:this.tokenProvider()},data:n}).catch((function(t){if(403===t.response.status)return i.logoutHandler(),Promise.reject();throw t}))}},{key:"getEvent",value:function(){return this.authenticatedApiFetch("get",p)}},{key:"addEvent",value:function(t,e,n,i,r){return this.authenticatedApiFetch("post",p,{name:t,location:e,description:n,date:i,time:r})}},{key:"removeEvent",value:function(t){return this.authenticatedApiFetch("delete","".concat(p).concat(t))}},{key:"updateEvent",value:function(t,e,n,i,r,a){return this.authenticatedApiFetch("put","".concat(p).concat(t),{name:e,location:n,description:i,date:r,time:a})}},{key:"login",value:function(){var t=Object(j.a)(b.a.mark((function t(e,n){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v()({method:"post",url:"".concat(p,"auth"),data:{username:e,password:n}});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}]),t}(),f=n(0),m=function(t){Object(u.a)(n,t);var e=Object(d.a)(n);function n(t){var i;return Object(c.a)(this,n),(i=e.call(this,t)).state={disabled:!1},i}return Object(o.a)(n,[{key:"submitHandler",value:function(t){var e=this;t.preventDefault(),this.setState({disabled:!0}),(this.props.currentEvent?this.props.apiClient.updateEvent(this.props.currentEvent._id,t.target.eventName.value,t.target.eventLocation.value,t.target.eventDescription.value,t.target.eventDate.value,t.target.eventTime.value):this.props.apiClient.addEvent(t.target.eventName.value,t.target.eventLocation.value,t.target.eventDescription.value,t.target.eventDate.value,t.target.eventTime.value)).then((function(){e.setState({disabled:!1}),document.getElementById("add-event-form").reset(),e.props.refreshList()})).catch((function(){console.log("Catch error!"),alert("An error occurred, please try again."),e.setState({disabled:!1})}))}},{key:"render",value:function(){var t,e,n,i,r,a=this;return Object(f.jsxs)("div",{children:[this.props.currentEvent?"Update":"Add",Object(f.jsx)("br",{}),Object(f.jsxs)("form",{onSubmit:function(t){return a.submitHandler(t)},id:"add-event-form",children:["Name: ",Object(f.jsx)("br",{}),Object(f.jsx)("input",{type:"text",defaultValue:null===(t=this.props.currentEvent)||void 0===t?void 0:t.name,name:"eventName",disabled:this.state.disabled}),Object(f.jsx)("br",{}),"Location: ",Object(f.jsx)("br",{}),Object(f.jsx)("input",{type:"text",defaultValue:null===(e=this.props.currentEvent)||void 0===e?void 0:e.location,name:"eventLocation",disabled:this.state.disabled}),Object(f.jsx)("br",{}),"Description: ",Object(f.jsx)("br",{}),Object(f.jsx)("input",{type:"text",defaultValue:null===(n=this.props.currentEvent)||void 0===n?void 0:n.description,name:"eventDescription",disabled:this.state.disabled}),Object(f.jsx)("br",{}),"Date: ",Object(f.jsx)("br",{}),Object(f.jsx)("input",{type:"text",defaultValue:null===(i=this.props.currentEvent)||void 0===i?void 0:i.date,name:"eventDate",disabled:this.state.disabled}),Object(f.jsx)("br",{}),"Time: ",Object(f.jsx)("br",{}),Object(f.jsx)("input",{type:"text",defaultValue:null===(r=this.props.currentEvent)||void 0===r?void 0:r.time,name:"eventTime",disabled:this.state.disabled}),Object(f.jsx)("br",{}),Object(f.jsx)("button",{type:"submit",disabled:this.state.disabled,children:"Submit"})]})]})}}]),n}(r.a.Component),x=function(t){Object(u.a)(n,t);var e=Object(d.a)(n);function n(t){var i;return Object(c.a)(this,n),(i=e.call(this,t)).state={events:[],currentEvent:void 0},i}return Object(o.a)(n,[{key:"refreshList",value:function(){var t=this;this.props.apiClient.getEvent().then((function(e){return t.setState({events:e.data})}))}},{key:"removeEvent",value:function(t){var e=this;this.props.apiClient.removeEvent(t).then((function(){return e.refreshList()}))}},{key:"updateEvent",value:function(t){this.setState({currentEvent:t})}},{key:"componentDidMount",value:function(){this.refreshList()}},{key:"buildRows",value:function(){var t=this;return this.state.events.map((function(e){return Object(f.jsxs)("tr",{children:[Object(f.jsx)("td",{children:e.name}),Object(f.jsx)("td",{children:e.location}),Object(f.jsx)("td",{children:e.description}),Object(f.jsx)("td",{children:e.date}),Object(f.jsx)("td",{children:e.time}),Object(f.jsxs)("td",{children:[Object(f.jsx)("button",{onClick:function(){return t.updateEvent(e)},children:"Update"}),Object(f.jsx)("button",{onClick:function(){return t.removeEvent(e._id)},children:"Remove"})]})]},e._id)}))}},{key:"render",value:function(){var t=this;return Object(f.jsxs)("div",{children:[Object(f.jsxs)("table",{children:[Object(f.jsx)("thead",{children:Object(f.jsxs)("tr",{children:[Object(f.jsx)("th",{children:"Event Name"}),Object(f.jsx)("th",{children:"Location"}),Object(f.jsx)("th",{children:"Description"}),Object(f.jsx)("th",{children:"Date"}),Object(f.jsx)("th",{children:"Time"})]})}),Object(f.jsx)("tbody",{children:this.buildRows()})]}),Object(f.jsx)("br",{}),Object(f.jsx)("br",{}),Object(f.jsx)(m,{apiClient:this.props.apiClient,refreshList:function(){t.refreshList(),t.setState({currentEvent:void 0})},currentEvent:this.state.currentEvent})]})}}]),n}(r.a.Component),g=function(t){Object(u.a)(n,t);var e=Object(d.a)(n);function n(t){var i;return Object(c.a)(this,n),(i=e.call(this,t)).state={disabled:!1},i}return Object(o.a)(n,[{key:"submitHandler",value:function(t){var e=this;t.preventDefault(),this.setState({disabled:!0}),this.props.apiClient.login(t.target.username.value,t.target.password.value).then((function(t){e.setState({disabled:!1}),e.props.loggedIn(t.data.token)})).catch((function(){alert("An error occurred, please try again"),e.setState({disabled:!1})}))}},{key:"render",value:function(){var t=this;return Object(f.jsxs)("div",{children:["Login",Object(f.jsx)("br",{}),Object(f.jsxs)("form",{onSubmit:function(e){return t.submitHandler(e)},children:["Username:",Object(f.jsx)("br",{}),Object(f.jsx)("input",{type:"text",name:"username",disabled:this.state.disabled}),Object(f.jsx)("br",{}),"Password:",Object(f.jsx)("br",{}),Object(f.jsx)("input",{type:"password",name:"password",disabled:this.state.disabled}),Object(f.jsx)("br",{}),Object(f.jsx)("br",{}),Object(f.jsx)("button",{type:"submit",disabled:this.state.disabled,children:"Submit"})]})]})}}]),n}(r.a.Component),k=function(t){Object(u.a)(n,t);var e=Object(d.a)(n);function n(t){var i;return Object(c.a)(this,n),(i=e.call(this,t)).state={token:window.localStorage.getItem("token")},i.apiClient=new O((function(){return i.state.token}),(function(){return i.logout()})),i}return Object(o.a)(n,[{key:"login",value:function(t){window.localStorage.setItem("token",t),this.setState({token:t})}},{key:"logout",value:function(){window.localStorage.removeItem("token"),this.setState({token:void 0})}},{key:"render",value:function(){var t=this;return this.state.token?Object(f.jsx)(x,{apiClient:this.apiClient}):Object(f.jsx)(g,{loggedIn:function(e){return t.login(e)},apiClient:this.apiClient})}}]),n}(r.a.Component),y=function(){return Object(f.jsx)("div",{children:Object(f.jsx)(k,{})})},E=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,46)).then((function(e){var n=e.getCLS,i=e.getFID,r=e.getFCP,a=e.getLCP,s=e.getTTFB;n(t),i(t),r(t),a(t),s(t)}))};s.a.render(Object(f.jsx)(r.a.StrictMode,{children:Object(f.jsx)(y,{})}),document.getElementById("root")),E()}},[[45,1,2]]]);
//# sourceMappingURL=main.ed8a1ba7.chunk.js.map